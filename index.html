<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <title>519e移动平台-大数据分析平台</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/jquery-ui.css" />
	<link rel="stylesheet" href="css/icheck/flat/blue.css" />
	<link href="css/main.css" rel="stylesheet">
	
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
<!--  <body onLoad="javascript:StartKPI();">-->

  <body>
  
    <div class="dg-main">
		<div class="dg-main-top">
			<div class="dg-main-top-imgbox">
				<img src="images/logo.png" />
			</div>
		</div>
    	<div class="container">	
    	    <div class="row">	
					  
    	  		<div class="col-lg-12 col-md-12">		
				    <h2 class="dg-main-container-title"><div class="sjtjimg"></div>数据统计</h2>

				    <div class="dg-main-small-box">
				        <div class="row">
						
					        <div class="col-md-4">
								<div class="dg-main-small-box-Category">
									<div class="dg-main-small-box-Category-left">
										<img src="images/money.png" />
										<h2>交易</h2>
									</div>
									<div class="dg-main-small-box-Category-center">
									
									</div>
									<div class="dg-main-small-box-Category-right">
										<h2 id="jiaoyi">￥888888.88</h2>
										<h5>今日新增<span id="jiaoyi_jr" class="leadcolor">￥888.88</span></h5>
									</div>
								</div>
							</div>
							
					        <div class="col-md-4">
								<div class="dg-main-small-box-Category">
									<div class="dg-main-small-box-Category-left">
										<img src="images/user.png" />
										<h2>用户</h2>
									</div>
									<div class="dg-main-small-box-Category-center">
									
									</div>
									<div class="dg-main-small-box-Category-right">
										<h2 id="yonghu">888888</h2>
										<h5>今日新增<span id="yonghu_jr" class="leadcolor">888</span></h5>
									</div>
								</div>
							</div>
							
							<div class="col-md-4">
								<div class="dg-main-small-box-Category">
									<div class="dg-main-small-box-Category-left">
										<img src="images/guahao.png" />
										<h2>挂号</h2>
									</div>
									<div class="dg-main-small-box-Category-center">
									
									</div>
									<div class="dg-main-small-box-Category-right">
										<h2 id="guahao">888888</h2>
										<h5>今日新增<span id="guahao_jr" class="leadcolor">888</span></h5>
									</div>
								</div>
							</div>
							
				        </div>
				    </div>					
		  		</div>
				
				<div class="col-lg-12 col-md-12">	
					<div class="timesearchbox">	
						<div class="row">	
							<div class="col-md-3 col-sm-5 col-xs-6 timesearchboxtime">
								<select class="form-control boxshowhide">
									<option value="allboxshow">全部</option>
									<option value="jiaotibox">交易</option>
									<option value="userbox">用户</option>
									<option value="guahaobox">挂号</option>
									<option value="othertibox">其他</option>
								</select>
							</div>	
							<div class="col-md-3 col-sm-5 col-xs-6 timesearchboxtime">
								<select class="form-control flotyearday">
									<option value="dayflot">日</option>
									<option value="yearflot">月</option>
								</select>
							</div>

							<div class="col-md-3 col-sm-7 col-xs-6 timesearchboxtime">
								<label for="dtp_input1" class="col-md-5 col-xs-12 control-label">时间自：</label>
								<div class="input-group col-md-7 col-xs-12 flotyearchangboxUI">
								  <input id="ui-datepicker" type="text" class="form-control" />
								  <span class="glyphicon glyphicon-calendar calendaricon" aria-hidden="true"></span>
								</div>	
								<div class="flotmonthchangbox col-md-7 col-xs-12">
									<select class="form-control flotbenginmonth">
										<option value="0" datayear = "2014">201401</option>
										<option value="1" datayear = "2014">201402</option>
										<option value="2" datayear = "2014">201403</option>
										<option value="3" datayear = "2014">201404</option>
										<option value="4" datayear = "2014">201405</option>
										<option value="5" datayear = "2014">201406</option>
										<option value="6" datayear = "2014">201407</option>
										<option value="7" datayear = "2014">201408</option>
										<option value="8" datayear = "2014">201409</option>
										<option value="9" datayear = "2014">201410</option>
										<option value="10" datayear = "2014" selected="selected">201411</option>
										<option value="11" datayear = "2014">201412</option>
										<option value="0" datayear = "2015">201501</option>
										<option value="1" datayear = "2015">201502</option>
										<option value="2" datayear = "2015">201503</option>
										<option value="3" datayear = "2015">201504</option>
										<option value="4" datayear = "2015">201505</option>
										<option value="5" datayear = "2015">201506</option>
										<option value="6" datayear = "2015">201507</option>
										<option value="7" datayear = "2015">201508</option>
										<option value="8" datayear = "2015">201509</option>
										<option value="9" datayear = "2015">201510</option>
										<option value="10" datayear = "2015">201511</option>
										<option value="12" datayear = "2015">201512</option>
									</select>
								</div>
							</div>
							<div class="col-md-3 col-sm-5 col-xs-6 timesearchboxtime">
								<label for="dtp_input2" class="col-md-3 col-xs-12 control-label">到：</label>
								<div class="input-group col-md-8 col-xs-12 flotyearchangboxUI">
								  <input id="ui-datepicker-2" type="text" class="form-control" />
								  <span class="glyphicon glyphicon-calendar calendaricon" aria-hidden="true"></span>
								</div>
								<div class="flotmonthchangbox col-md-7 col-xs-12">
									<select class="form-control flotendmonth">
										<option value="0" datayear = "2014">201401</option>
										<option value="1" datayear = "2014">201402</option>
										<option value="2" datayear = "2014">201403</option>
										<option value="3" datayear = "2014">201404</option>
										<option value="4" datayear = "2014">201405</option>
										<option value="5" datayear = "2014">201406</option>
										<option value="6" datayear = "2014">201407</option>
										<option value="7" datayear = "2014">201408</option>
										<option value="8" datayear = "2014">201409</option>
										<option value="9" datayear = "2014">201410</option>
										<option value="10" datayear = "2014">201411</option>
										<option value="11" datayear = "2014">201412</option>
										<option value="0" datayear = "2015">201501</option>
										<option value="1" datayear = "2015">201502</option>
										<option value="2" datayear = "2015">201503</option>
										<option value="3" datayear = "2015">201504</option>
										<option value="4" datayear = "2015">201505</option>
										<option value="5" datayear = "2015">201506</option>
										<option value="6" datayear = "2015">201507</option>
										<option value="7" datayear = "2015">201508</option>
										<option value="8" datayear = "2015">201509</option>
										<option value="9" datayear = "2015">201510</option>
										<option value="10" datayear = "2015">201511</option>
										<option value="12" datayear = "2015" selected="selected">201512</option>
									</select>
								</div>	
							</div>	
							
							<div class="col-md-4 col-sm-12 col-xs-12 timesearchboxtime">
								<input type="text" class="form-control inputsearch" placeholder="请输入查询的医院名">
								<button class="btn btn-search">查询</button>
							</div>	
						</div>										
					</div>
				</div>	
				
				
				<div class="col-lg-12 col-md-12 showhide icheckflag" dataicheckflag="1" id="jiaotibox">	
					<div class="jytjbox">	
					
						<div class="row">
						
							<div class="jytjbox-top">
								<div class="col-md-6 col-sm-6 col-xs-7">
									<span class="sjtjtitle">交易统计</span><span class="sitjtime">数据时间:全部</span>
								</div>
								<div class="col-md-6 col-sm-6 col-xs-5 jytjbox-top-right">
									<button class="leverstatus funs toadyfun" dataid="chart-flot-box" data-flot='{"dataflotbox":"options","datasetflot":"dataset"}'>今日</button>
									<button class="btn focusstatus funs totalfun" dataid="upDateTrade">累计</button>
								</div>
							</div>
														
							<div class="col-md-12 yjtjbox">
								<h3>
									<div class="form-group">											
										<label icheckinturn="0" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">成功预约金额</span></label>
										<label icheckinturn="1" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">交易额</span></label>
									</div>					
								</h3>
								<div class="chart-flot">
									<div id="chart-flot-box"></div>
									<div class="chart-flot-box-legend chart-flot-box-legend2"></div>
								</div>	
							</div>	
							
							<div class="jytjbox-bottom">
								<div class="col-md-6 jytjbox-bottom-left">
									<h3>资金来源</h3>
									<div class="pie-flot chart-flot">
										<div id="placeholder"></div>
										<div class="chart-flot-box-legend"></div>
									</div>	
								</div>	
								<div class="col-md-6 jytjbox-bottom-left">
									<h3>交易额</h3>
									<table class="table table-bordered">
									  <thead>
										<tr>
										  <th>#</th>
										  <th>预约挂号</th>
										  <th>挂号</th>
										  <th>交易金额</th>
										</tr>
									  </thead>
									  <tbody>
										<tr>
										  <th scope="row">支付宝</th>
										  <td>1000</td>
										  <td>1000</td>
										  <td>1000</td>
										</tr>
										<tr>
										  <th scope="row">微信</th>
										  <td>1000</td>
										  <td>1000</td>
										  <td>1000</td>
										</tr>
									    <tr>
										  <th scope="row">网银</th>
										  <td>1000</td>
										  <td>1000</td>
										  <td>1000</td>
										</tr>
										<tr>
										  <th scope="row">现金</th>
										  <td>1000</td>
										  <td>1000</td>
										  <td>1000</td>
										</tr>
									  </tbody>
									</table>
								</div>	
							</div>	
						</div>			
					</div>
				</div>	
				
				
				
				<div class="col-lg-12 col-md-12 showhide icheckflag" dataicheckflag="1" id="userbox">	
					<div class="usertjbox">	
					
						<div class="row">
						
							<!--<div class="col-md-6">-->
								<div class="usertjbox-leftbox">
									<div class="jytjbox-top">
										<div class="col-md-6 col-sm-6 col-xs-7">
											<span class="sjtjtitle">用户统计</span><span class="sitjtime">数据时间:全部</span>
										</div>
										<div class="col-md-6 col-sm-6 col-xs-5 jytjbox-top-right">
											<button class="leverstatus funs toadyfun" dataid="chart-flot-box2" data-flot='{"dataflotbox":"options2","datasetflot":"dataset2"}'>今日</button>
											<button class="btn focusstatus funs totalfun" dataid="upDateUser">累计</button>
										</div>
									</div>
									<div class="jytjbox-bottom-padding">
										<h3>
											<div class="form-group">											
												<label icheckinturn="0" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">用户数</span></label>
												<label icheckinturn="1" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked/> <span class="graycolorfont">日活用户数</span></label>
												<label icheckinturn="2" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">绑卡数</span></label>
												<label icheckinturn="3" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked/> <span class="graycolorfont">绑定会员数</span></label>
											</div>					
										</h3>
										<div class="chart-flot">
											<div id="chart-flot-box2"></div>
											<div class="chart-flot-box-legend"></div>
										</div>	
									</div>	
								</div>
							<!--</div>-->
							
						</div>			
					</div>
				</div>
				
				
				<div class="col-lg-12 col-md-12 showhide icheckflag" dataicheckflag="1" id="guahaobox">	
					<div class="usertjbox">	
					
						<div class="row">
				
							<!--<div class="col-md-6">-->
								<div class="usertjbox-rightbox">
									<div class="jytjbox-top">
										<div class="col-md-6 col-sm-6 col-xs-7">
											<span class="sjtjtitle">挂号统计</span><span class="sitjtime">数据时间:全部</span>
										</div>
										<div class="col-md-6 col-sm-6 col-xs-5 jytjbox-top-right">
											<button class="leverstatus funs toadyfun" dataid="chart-flot-box3" data-flot='{"dataflotbox":"options3","datasetflot":"dataset3"}'>今日</button>
											<button class="btn focusstatus funs totalfun" dataid="upDateRegister">累计</button>
										</div>
									</div>
									<div class="jytjbox-bottom-padding">
	
										<h3>
											<div class="form-group">											
												<label icheckinturn="0" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">挂号数</span></label>
												<label icheckinturn="1" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">排队数</span></label>
											</div>					
										</h3>
										<div class="chart-flot">
											<div id="chart-flot-box3"></div>
											<div class="chart-flot-box-legend chart-flot-box-legend2"></div>
										</div>	
									
									</div>	
								</div>	
							<!--</div>-->
							
						</div>			
					</div>
				</div>
							
							
				<div class="col-lg-12 col-md-12 showhide icheckflag" dataicheckflag="1" id="othertibox">	
					<div class="usertjbox">	
					
						<div class="row">
						
							<!--<div class="col-md-6">-->
								<div class="usertjbox-leftbox">
									<div class="jytjbox-top">
										<div class="col-md-6 col-sm-6 col-xs-7">
											<span class="sjtjtitle">其他统计</span><span class="sitjtime">数据时间:全部</span>
										</div>
										<div class="col-md-6 col-sm-6 col-xs-5 jytjbox-top-right">
											<button class="leverstatus funs toadyfun" dataid="chart-flot-box4" data-flot='{"dataflotbox":"options4","datasetflot":"dataset4"}'>今日</button>
											<button class="btn focusstatus funs totalfun" dataid="upDateOther">累计</button>
										</div>
									</div>
									<div class="jytjbox-bottom-padding">
										<h3>
											<div class="form-group">											
												<label icheckinturn="0" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">报告单查看数</span></label>
												<label icheckinturn="1" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked/> <span class="graycolorfont">问卷调查户数</span></label>
												<label icheckinturn="2" class="icheck"><input type="checkbox" name="checkboxes" class="icheckboxchart" checked /> <span class="graycolorfont">注销数</span></label>
											</div>					
										</h3>
										<div class="chart-flot databox">
											<div id="chart-flot-box4"></div>
											<div class="chart-flot-box-legend chart-flot-box-legend3"></div>
										</div>	
									</div>	
								</div>
							<!--</div>-->

						</div>			
					</div>
				</div>
<div id='tooltip'></div><div id='tooltip2'></div><div id='tooltip3'></div><div id='tooltip4'></div>
		    </div>		  
    	</div>
		
<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" id="myModal">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
<img src="images/009.gif"/>
    </div>
  </div>
</div>

    </div>  

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>

<script src="js/jquery-ui.custom.js"></script>

<script src="js/excanvas.min.js"></script>
<script src="js/jquery.flot.js"></script>
<script src="js/jquery.flot.pie.js"></script>
<script src="js/jquery.flot.selection.js"></script>
<script src="js/jquery.flot.time.js"></script>

<script src="js/jquery.icheck.min.js"></script>

<script>
//当点击icheck input的时候重绘flot,记录状态！记录当前flot是今日还是月还是日。 month为1,day为2,today为3。 
//var icheckboxflag;  // 明天还是改为放dom节点吧，不然这个状态值不好控制,在每一个绘制柱状图的最大box上都有dataicheckflag这个属性，当改变月日今日时，dataicheckflag这个状态会变为对应的数字

$('#myModal').modal({backdrop: 'static'});


var myDate = new Date(), myYear = myDate.getFullYear(), myMonth = myDate.getMonth(),  myDay = myDate.getDate(),
myHours = myDate.getHours(), myMinutes = myDate.getMinutes(), mySeconds = myDate.getSeconds();

var yaxismin,yaxismax,xaxesmin = (new Date(myYear, 0, 1)).getTime(), xaxesmax = (new Date(myYear, 12, 1)).getTime(),timeformatval = "%y/%m", 
flotbenginmonth, flotendmonth,flotbenginyear, flotendyear, stoptoday;


$(document).ready(function(){
	var s = [[1, 25]],h = [[1, 35]],c = [[1, 35]],hl = [[1, 35]];
	
	var sin4 = [[new Date(myYear, 0, 1), 20],[new Date(myYear, 1, 1), 23],[new Date(myYear, 2, 1), 35], [new Date(myYear, 3, 1), 66], [new Date(myYear, 4, 1), 29], [new Date(myYear, 5, 1), 25], [new Date(myYear, 6, 1), 23], [new Date(myYear, 7, 1), 25], [new Date(myYear, 8, 1), 38], [new Date(myYear, 9, 1), 25], [new Date(myYear, 10, 1), 43], [new Date(myYear, 11, 1), 65]],
	
	hling4 = [[new Date(myYear, 0, 1), 10],[new Date(myYear, 1, 1), 43],[new Date(myYear, 2, 1), 85], [new Date(myYear, 3, 1), 56], [new Date(myYear, 4, 1), 39], [new Date(myYear, 5, 1), 25], [new Date(myYear, 6, 1), 23], [new Date(myYear, 7, 1), 85], [new Date(myYear, 8, 1), 38], [new Date(myYear, 9, 1), 25], [new Date(myYear, 10, 1), 43], [new Date(myYear, 11, 1), 65]],
	
	cos4 = [[new Date(myYear, 0, 1), 20],[new Date(myYear, 1, 1), 63],[new Date(myYear, 2, 1), 35], [new Date(myYear, 3, 1), 66], [new Date(myYear, 4, 1), 29], [new Date(myYear, 5, 1), 25], [new Date(myYear, 6, 1), 23], [new Date(myYear, 7, 1), 25], [new Date(myYear, 8, 1), 78], [new Date(myYear, 9, 1), 25], [new Date(myYear, 10, 1), 3], [new Date(myYear, 11, 1), 95]],

	hling = [[new Date(myYear, 0, 1), 30],[new Date(myYear, 1, 1), 33],[new Date(myYear, 2, 1), 45], [new Date(myYear, 3, 1), 56], [new Date(myYear, 4, 1), 39], [new Date(myYear, 5, 1), 25], [new Date(myYear, 6, 1), 23], [new Date(myYear, 7, 1), 30], [new Date(myYear, 8, 1), 36], [new Date(myYear, 9, 1), 5], [new Date(myYear, 10, 1), 73], [new Date(myYear, 11, 1), 35]];

$('#myModal').modal('hide');

	upDatePay(s,h,c,hl);
	upDateOther(sin4, hling4, cos4);
	upDateTrade(sin4, hling4);
	upDateRegister(cos4, hling4);
	upDateUser(hling4, cos4, hling, sin4); 

//在处于不同月日今日状态柱状图box下，分别点击各个不同box中的icheck重新绘制柱状图---直接获取的是原先date中存的值，没有重新调取，用的是是dom节点上写上和date数据中对应的索引值！后期今日的应该要改为ajax获取的！------------------------------------
	$('.icheckboxchart').on('ifClicked', function(event){ 

	    var icheckinturn = $(this).parents("label").attr("icheckinturn"); //console.log($(this).parents("label").siblings(".icheck").length);
		var getarray = new Array();
		if($(this).parents("label").hasClass("icheck")){
			$(this).parents("label").removeClass("icheck").addClass("noicheck");
		}else if($(this).parents("label").hasClass("noicheck")){
			$(this).parents("label").removeClass("noicheck").addClass("icheck");
		} 

		//得到获取数据的索引
		//$.each($(this).parents("label").siblings(".icheck"), function(key, val) {   得不到正确的个数，如果重新选中的话不会包含本身，刚开始还以为是dom加icheck延迟的问题
		$.each($(this).parents(".form-group").find(".icheck"), function(key, val) {
			 getarray.push($(val).attr("icheckinturn"));
		});

		/*$.each($(this).parents(".form-group").find(".icheckbox_flat-blue"), function(key, val) {
			if($(val).hasClass("checked")){
				console.log($(val).parents("label").attr("icheckinturn"));
			}
			 //getarray.push($(val).attr("icheckinturn"));  parents("label").attr("icheckinturn")
		});
		*/

		 
		//delete dataset[icheckinturn];$(val)
		//console.log(dataset); 
		//delete options["colors"][icheckinturn];
		//console.log(options["colors"]); 
		//console.log(dataset[icheckinturn]);   // 当前选择的数据值，以便于后期删除重绘
		//console.log(options["colors"][icheckinturn]);     // 当前选择的颜色值，以便于后期删除重绘
		
		if(parseInt($(this).parents(".icheckflag").attr("dataicheckflag")) == 1){
			//month
			if($(this).parents(".icheckflag").attr("id") == "jiaotibox"){
			    var jiaotiboxval = new Array();
				jiaotiboxval.length=0;
				options["colors"].length = 0; 
				var jiaotiboxvalcolor = new Array("#ff8b3d","#32d2c9");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						jiaotiboxval.push(dataset[val]);
						options["colors"].push(jiaotiboxvalcolor[val]);
					});
					if(jiaotiboxval != null){
						$.plot("#chart-flot-box", jiaotiboxval, options);
					}
				}
			}
			if($(this).parents(".icheckflag").attr("id") == "userbox"){

			    var userboxval = new Array();
				userboxval.length=0;
				options2["colors"].length = 0;  
				var userboxvalcolor = new Array("#ff8b3d","#32d2c9", "#8175c7", "#5fbf00");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						userboxval.push(dataset2[val]);
						options2["colors"].push(userboxvalcolor[val]);
					});
					if(userboxval != null){
						$.plot("#chart-flot-box2", userboxval, options2);

					}
				}
			}
			if($(this).parents(".icheckflag").attr("id") == "guahaobox"){

				var guahaoboxval = new Array();
				guahaoboxval.length=0;
				options3["colors"].length = 0;  
				var guahaoboxvalcolor = new Array("#32d2c9", "#ff8b3d");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						guahaoboxval.push(dataset3[val]);
						options3["colors"].push(guahaoboxvalcolor[val]);
					});
					if(guahaoboxval != null){
						$.plot("#chart-flot-box3", guahaoboxval, options3);

					}
				}
			}
			if($(this).parents(".icheckflag").attr("id") == "othertibox"){
				
				var othertiboxval = new Array();
				othertiboxval.length=0;
				options4["colors"].length = 0;  
				var othertiboxvalcolor = new Array("#32d2c9", "#ff8b3d","#8175c7");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						othertiboxval.push(dataset4[val]);
						options4["colors"].push(othertiboxvalcolor[val]);
					});
					if(othertiboxval != null){
						$.plot("#chart-flot-box4", othertiboxval, options4);

					}
				}
				
			}
		}
		
		if(parseInt($(this).parents(".icheckflag").attr("dataicheckflag")) == 2){
			//day
			if($(this).parents(".icheckflag").attr("id") == "jiaotibox"){
			
				 var jiaotiboxval2 = new Array();
				 jiaotiboxval2.length=0;
				 options["colors"].length = 0; 
				 var jiaotiboxvalcolor2 = new Array("#ff8b3d","#32d2c9");  
				 if(getarray.length>0){
					$.each(getarray, function(i, val) {
						jiaotiboxval2.push(dataset[val]);
						options["colors"].push(jiaotiboxvalcolor2[val]);
					});
					if(jiaotiboxval2 != null){
						options.xaxes[0].timeformat = "%d";	
						options.xaxes[0].tickFormatter = null;	
						options.xaxes[0].minTickSize = [1, "day"];
						options.xaxes[0].tickSize = [1,"day"];	
						$.plot("#chart-flot-box", jiaotiboxval2, options);
					}
				 }
			    	
			}
			if($(this).parents(".icheckflag").attr("id") == "userbox"){
			
			    var userboxval2 = new Array();
				userboxval2.length=0;
				options2["colors"].length = 0;  
				var userboxvalcolor2 = new Array("#ff8b3d","#32d2c9", "#8175c7", "#5fbf00");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						userboxval2.push(dataset2[val]);
						options2["colors"].push(userboxvalcolor2[val]);
					});
					if(userboxval2 != null){
						options2.xaxes[0].timeformat = "%d";	
						options2.xaxes[0].tickFormatter = null;	
						options2.xaxes[0].minTickSize = [1, "day"];
						options2.xaxes[0].tickSize = [1,"day"];	
						$.plot("#chart-flot-box2", userboxval2, options2);

					}
				}
			}
			if($(this).parents(".icheckflag").attr("id") == "guahaobox"){
			
			    var guahaoboxval2 = new Array();
				guahaoboxval2.length=0;
				options3["colors"].length = 0;  
				var guahaoboxvalcolor2 = new Array("#32d2c9", "#ff8b3d");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						guahaoboxval2.push(dataset3[val]);
						options3["colors"].push(guahaoboxvalcolor2[val]);
					});
					if(guahaoboxval2 != null){
						options3.xaxes[0].timeformat = "%d";	
						options3.xaxes[0].tickFormatter = null;	
						options3.xaxes[0].minTickSize = [1, "day"];
						options3.xaxes[0].tickSize = [1,"day"];	
						$.plot("#chart-flot-box3", guahaoboxval2, options3);

					}
				}
			   
			}
			if($(this).parents(".icheckflag").attr("id") == "othertibox"){
			
			    var othertiboxval2 = new Array();
				othertiboxval2.length=0;
				options4["colors"].length = 0;  
				var othertiboxvalcolor2 = new Array("#32d2c9", "#ff8b3d","#8175c7"); 
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						othertiboxval2.push(dataset4[val]);
						options4["colors"].push(othertiboxvalcolor2[val]);
					});
					if(othertiboxval2 != null){
					
						options4.xaxes[0].timeformat = "%d";	
						options4.xaxes[0].tickFormatter = null;	
						options4.xaxes[0].minTickSize = [1, "day"];
						options4.xaxes[0].tickSize = [1,"day"];	
						$.plot("#chart-flot-box4", othertiboxval2, options4);

					}
				}
			}
		}
		
		if(parseInt($(this).parents(".icheckflag").attr("dataicheckflag")) == 3){
			//today
			if($(this).parents(".icheckflag").attr("id") == "jiaotibox"){
				 var jiaotiboxval3 = new Array();
				 jiaotiboxval3.length=0;    
				 //options["colors"].length = 0; 
				 optionstoday["colors"].length = 0;
				 var jiaotiboxvalcolor3 = new Array("#ff8b3d","#32d2c9");  
				 if(getarray.length>0){  
					$.each(getarray, function(i, val) {
						jiaotiboxval3.push(datasettoday[val]);
						optionstoday["colors"].push(jiaotiboxvalcolor3[val]);
					});
					if(jiaotiboxval3 != null){
						$.plot("#chart-flot-box", jiaotiboxval3, optionstoday);
					}
				 }
			}
			if($(this).parents(".icheckflag").attr("id") == "userbox"){
				var userboxval3 = new Array();
				userboxval3.length=0;
				optionstoday["colors"].length = 0;  
				var userboxvalcolor3 = new Array("#ff8b3d","#32d2c9", "#8175c7", "#5fbf00");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						userboxval3.push(datasettoday2[val]);
						optionstoday["colors"].push(userboxvalcolor3[val]);
					});
					if(userboxval3 != null){
						$.plot("#chart-flot-box2", userboxval3, optionstoday);

					}
				}
			}
			if($(this).parents(".icheckflag").attr("id") == "guahaobox"){
			 	var guahaoboxval3 = new Array();
				guahaoboxval3.length=0;
				optionstoday["colors"].length = 0;  
				var guahaoboxvalcolor3 = new Array("#32d2c9", "#ff8b3d");  
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						guahaoboxval3.push(datasettoday3[val]);
						optionstoday["colors"].push(guahaoboxvalcolor3[val]);
					});
					if(guahaoboxval3 != null){
						$.plot("#chart-flot-box3", guahaoboxval3, optionstoday);

					}
				}
			}
			if($(this).parents(".icheckflag").attr("id") == "othertibox"){
				var othertiboxval3 = new Array();
				othertiboxval3.length=0;
				optionstoday["colors"].length = 0;  
				var othertiboxvalcolor3 = new Array("#32d2c9", "#ff8b3d","#8175c7"); 
				if(getarray.length>0){
					$.each(getarray, function(i, val) {
						othertiboxval3.push(datasettoday4[val]);
						optionstoday["colors"].push(othertiboxvalcolor3[val]);
					});
					if(othertiboxval3 != null){	
						$.plot("#chart-flot-box4", othertiboxval3, optionstoday);

					}
				}
			}
		}
	}); 

//在处于不同月日今日状态柱状图box下，分别点击各个不同box中的icheck重新绘制柱状图-----END----------------------------------
//点击累计，柱状图变为初始化的月份状态-------------------------------------------
	$(".totalfun").click(function(){
		var totalfunid = $(this).attr("dataid"); 
		if($(this).parents(".icheckflag").find(".form-group").find("label").hasClass("noicheck")){
			$(this).parents(".icheckflag").find(".form-group").find("label").removeClass("noicheck").addClass("icheck");
		} 
			
		if(totalfunid == "upDateOther"){
		    $("#othertibox").attr("dataicheckflag","1");
			$("#othertibox").find(".form-group").find("input").iCheck('check');
			
			if(othertiboxclear) clearInterval(othertiboxclear); 
			console.log("我是othertibox我被clear了！");
			
			upDateOther(sin4, hling4, cos4);
		}
		if(totalfunid == "upDateTrade"){
		    $("#jiaotibox").attr("dataicheckflag","1");
			$("#jiaotibox").find(".form-group").find("input").iCheck('check');
			
			if(jiaotiboxclear) clearInterval(jiaotiboxclear); 
			
			upDateTrade(sin4, hling4);
		}
		if(totalfunid == "upDateRegister"){
			$("#guahaobox").attr("dataicheckflag","1");
			$("#guahaobox").find(".form-group").find("input").iCheck('check');
			
			if(guahaoboxclear) clearInterval(guahaoboxclear); 
			
			upDateRegister(cos4, hling4);
		}
		
		if(totalfunid == "upDateUser"){ 
			$("#userbox").attr("dataicheckflag","1");
			$("#userbox").find(".form-group").find("input").iCheck('check');
			
			if(userboxclear) clearInterval(userboxclear); 
			
			upDateUser(hling4, cos4, hling, sin4); 
		}
	});
//点击累计，柱状图变为初始化的月份状态--END-------------------------------------	

});	

/*----------------------------------------------------其他统计bengin---------*/
var dataset4;
var options4;
function upDateOther(bgdcks_d, wj_d, zx_d) {
	dataset4 = [
	        		{ data: bgdcks_d, label: "报告单查看数"},
	        		{ data: wj_d, label: "问卷调查户数"},
	        		{ data: zx_d, label: "注销数"}
	        	];
	        options4 = {
	        		series: {
	        				lines: {
	        					show: true
	        				},
	        				points: {
	        					show: true
	        				}
	        			},
	        			yaxis: {
	        				min: -1,
	        				max: 120
	        			},
	        		    xaxes: [{
	        				mode: "time",             		
	        				timeformat: timeformatval,
	        				minTickSize: [1, "month"],	
	        				min: xaxesmin,
	        				max: xaxesmax,
	        				color: "#fff",
	        				axisLabelUseCanvas: true
	        			}],
	        			legend: {
	        				noColumns: 0,
	        				labelBoxBorderColor: "#fff",
	        				container:$("#chart-flot-box4").next(".chart-flot-box-legend"),
	        				backgroundColor:"#fff",
	        				labelFormatter: function(label, series){
	        					return '<div style="line-height: 20px;font-size:14px;text-align:center;color:#333;margin-left: 10px;">'+label+'</div>';
	        				}
	        			},
	        			grid: {
	        				clickable: true,
	        				hoverable: true,
	        				borderWidth: 1,
	        				borderColor: "#fff",
	        				color:"#333"
	        			},
	        			colors: ["#32d2c9", "#ff8b3d","#8175c7"]
	        	};
	        	
	        	
				
	        	$("#chart-flot-box4").bind("plothover", function (event, pos, item) {
	        		if (item) {  //.toFixed(2)
	        			var x = item.datapoint[0].toFixed(0),
							x = x.substring(0,10);
	        				y = item.datapoint[1].toFixed(0);

	        			$("#tooltip4").html(item.series.label + " 日期是 " + getLocalTime(x) + ",  轴坐标值是" + y)
	        				.css({top: item.pageY+5, left: item.pageX+5})
	        				.fadeIn(200);
	        		} else {
	        			$("#tooltip4").hide();
	        		}
	        	});
	        	
	        	$.plot("#chart-flot-box4", dataset4, options4);
	        	
}
			  	
/*----------------------------------------------------其他统计end---------*/

/*----------------------------------------------------交易金额饼状图统计bengin---------*/
var databzt;
var optionbzt;
var placeholder = $("#placeholder");
function upDatePay(weixin, zhifubao, wangying, xianjing) {
	databzt = [
	           	{ label: "微信支付", data: weixin},
	           	{ label: "支付宝", data: zhifubao },
	           	{ label: "网银", data: wangying },
	           	{ label: "现金支付", data: xianjing }
	           ]

	           optionbzt = {
	           	series: {
	           		pie: {
	           			innerRadius: 0.5,
	           			show: true
	           		}
	           	},
	           	legend: {
	           		noColumns: 0,
	           		labelBoxBorderColor: "#fff",
	           		backgroundColor:"#fff",
	           		labelFormatter: function(label, series){
	           			return '<div style="font-size:12px;line-height: 20px;text-align:left;color:#333;">'+label+'<span style="text-indent: 10px;font-size:18px;color:'+series.color+'">'+Math.round(series.percent)+'%</span></div>';
	           		},
	           		container: $("#placeholder").next(".chart-flot-box-legend")
	           	},
	           	stroke:{
	           		colors: ["#5fbf00", "#ff8b3d", "#32d2c9", "#8175c7"]
	           	}
	           };

	           $.plot(placeholder, databzt, optionbzt);
}

/*----------------------------------------------------交易金额饼状图统计bengin---------*/

/*----------------------------------------------------交易统计柱状图bengin---------*/
var dataset;
var options;
function upDateTrade(yueyu, jiaoyi) {
	dataset = [
	       		{ data: yueyu, label: "成功预约金额"},
	       		{ data: jiaoyi, label: "交易额"}
	       	]

	       	options = {
	       			series: {
	       				lines: {
	       					show: true
	       				},
	       				points: {
	       					show: true
	       				}
	       			},
	       			xaxes: [{
	       				mode: "time",             		
	       				timeformat: timeformatval,
	       				minTickSize: [1, "month"],	
	       				min: xaxesmin,
	       				max: xaxesmax,
	       				color: "#fff",
	       				axisLabelUseCanvas: true
	       			}],
	       			yaxis: {
	       				min: -1,
	       				max: 120
	       			},
	       			legend: {
	                       noColumns: 0,
	                       labelBoxBorderColor: "#fff",
	       				container:$("#chart-flot-box").next(".chart-flot-box-legend"),
	       				backgroundColor:"#fff",
	       			    labelFormatter: function(label, series){
	       					return '<div style="font-size:14px;text-align:left;color:#333;margin-left: 10px;">'+label+'</div>';
	       				}
	                   },
	                   grid: {
	       				clickable: true,
	                       hoverable: true,
	                       borderWidth: 1,
	                       borderColor: "#fff",
	       				color:"#333"
	                   },
	                   colors: ["#ff8b3d", "#32d2c9"]
	       		};
	       				
	       		$("#chart-flot-box").bind("plothover", function (event, pos, item) {
	       			if (item) {
	       				var x = item.datapoint[0].toFixed(0),
							x = x.substring(0,10);
	        				y = item.datapoint[1].toFixed(0);

	       				$("#tooltip").html(item.series.label + " 日期是 " + getLocalTime(x) + ",  轴坐标值是" + y)
	       					.css({top: item.pageY+5, left: item.pageX+5})
	       					.fadeIn(200);
	       			} else {
	       				$("#tooltip").hide();
	       			}
	       		});
	       		
	       		$.plot("#chart-flot-box", dataset, options);
	       		
}
	
/*----------------------------------------------------交易统计柱状图end---------*/		


/*----------------------------------------------------用户统计柱状bengin---------*/	
var dataset2;
var options2
function upDateUser(yonghu, rihuoyonghu, bangka, bangdinghuiyuan) {
	dataset2 = [
	            	{ data: yonghu, label: "用户数"},
	            	{ data: rihuoyonghu, label: "日活用户数"},
	            	{ data: bangka, label: "绑卡数"},
	            	{ data: bangdinghuiyuan, label: "绑定会员数"}
	            ];

	           options2 = {
	               series: {
	            		lines: {
	            			show: true
	            		},
	            		points: {
	            			show: true
	            		}
	            	},
	            	yaxis: {
	            		min: -1,
	            		max: 120
	            	},
	            	xaxes: [{
	            		mode: "time",             		
	            		timeformat: timeformatval,
	            		minTickSize: [1, "month"],	
	            		min: xaxesmin,
	            		max: xaxesmax,
	            		color: "#fff",
	            		axisLabelUseCanvas: true
	            	}],
	            	legend: {
	            		noColumns: 0,
	            		labelBoxBorderColor: "#fff",
	            		container:$("#chart-flot-box2").next(".chart-flot-box-legend"),
	            		backgroundColor:"#fff",
	            		labelFormatter: function(label, series){
	            			return '<div style="line-height: 20px;font-size:14px;text-align:left;color:#333;">'+label+'</div>';
	            		}
	            	},
	            	grid: {
	            		clickable: true,
	            		hoverable: true,
	            		borderWidth: 1,
	            		borderColor: "#fff",
	            		color:"#333"
	            	},
	            	colors: ["#ff8b3d", "#32d2c9", "#8175c7", "#5fbf00"]
	            }

	            $("#chart-flot-box2").bind("plothover", function (event, pos, item) {
	            	if (item) {
	            		var x = item.datapoint[0].toFixed(0),
							x = x.substring(0,10);
	        				y = item.datapoint[1].toFixed(0);

	            		$("#tooltip2").html(item.series.label + " 日期是 " + getLocalTime(x) + ",  轴坐标值是" + y)
	            			.css({top: item.pageY+5, left: item.pageX+5})
	            			.fadeIn(200);
	            	} else {
	            		$("#tooltip2").hide();
	            	}
	            });

	            $.plot("#chart-flot-box2", dataset2, options2);
}
	
/*----------------------------------------------------用户统计柱状图end---------*/	

/*----------------------------------------------------挂号统计柱状图bengin---------*/		
var dataset3;
var options3;
function upDateRegister(guahao, paidui) {
	dataset3 = [
	            	{ data: guahao, label: "挂号数"},
	            	{ data: paidui, label: "排队数"}
	            ];

	            options3 = {
	            	series: {
	            		lines: {
	            			show: true
	            		},
	            		points: {
	            			show: true
	            		}
	            	},
	            	yaxis: {
	            		min: -1,
	            		max: 120
	            	},
	            	xaxes: [{
	            		mode: "time",             		
	            		timeformat: timeformatval,
	            		minTickSize: [1, "month"],	
	            		min: xaxesmin,
	            		max: xaxesmax,
	            		color: "#fff",
	            		axisLabelUseCanvas: true
	            	}],
	            	legend: {
	            		noColumns: 0,
	            		labelBoxBorderColor: "#fff",
	            		container:$("#chart-flot-box3").next(".chart-flot-box-legend"),
	            		backgroundColor:"#fff",
	            		labelFormatter: function(label, series){
	            			return '<div style="font-size:14px;text-align:left;color:#333;margin-left: 10px;">'+label+'</div>';
	            		}
	            	},
	            	grid: {
	            		clickable: true,
	            		hoverable: true,
	            		borderWidth: 1,
	            		borderColor: "#fff",
	            		color:"#333"
	            	},
	            	colors: ["#32d2c9", "#ff8b3d"]
	            }

	            $("#chart-flot-box3").bind("plothover", function (event, pos, item) {
	            	if (item) {
	            		var x = item.datapoint[0].toFixed(0),
							x = x.substring(0,10);
	        				y = item.datapoint[1].toFixed(0);

	            		$("#tooltip3").html(item.series.label + " 日期是 " + getLocalTime(x) + ",  轴坐标值是" + y)
	            			.css({top: item.pageY+5, left: item.pageX+5})
	            			.fadeIn(200);
	            	} else {
	            		$("#tooltip3").hide();
	            	}
	            });

	            $.plot("#chart-flot-box3", dataset3, options3);
}

/*----------------------------------------------------挂号统计柱状图end---------*/	
			

/*----------------------------------------------------今日区间柱状图bengin 和其他的不搭架---------*/

var setTimeoutt, othertiboxclear,jiaotiboxclear,guahaoboxclear,userboxclear;	 //定时器，用于保存定时器，便于停止定时器
var dataid=""; //用于保存今日块，以便于判断是哪个今日块执行switch
        
var jiaotiboxtoday, userboxtoday, guahaoboxtoday, othertiboxtoday;

//点击今日，调取updatetoday函数
$(".toadyfun").click(function(){
	dataid = $(this).attr("dataid"); 
	
	if($("#"+dataid).parents(".icheckflag").find(".form-group").find("label").hasClass("noicheck")){
		$("#"+dataid).parents(".icheckflag").find(".form-group").find("label").removeClass("noicheck").addClass("icheck");
	} 
		
	$("#"+dataid).parents(".icheckflag").find(".form-group").find("input").iCheck('check');

	settodayval()
});

function settodayval(){

	//随机取时间区间值,后期可以删掉bengin-------------------------
	var data = [], datatoday2 = [], datatoday3 = [], datatoday4 = [];
	var totalPoints = 100;
	
	function getdata1(){
	
		data.length = 0; 
		var updateInterval;

		var now = (new Date(myYear, myMonth, myDay, myHours, myMinutes-32)).getTime();
		while (data.length < totalPoints) {     
			var y = Math.random() * 100;
			updateInterval = 1000*60*2;
			
			var t = [now += updateInterval, y];
			datatoday2.push(t);
			
			y = Math.random() * 100;
			t = [now += updateInterval, y];
			data.push(t);
			
			y = Math.random() * 100;
			t = [now += updateInterval, y];
			datatoday3.push(t);

			y = Math.random() * 100;
			t = [now += updateInterval, y];
			datatoday4.push(t);
		}
	}
	
	getdata1();

	//随机取时间区间值,后期可以删掉end------------------------

    updatetoday(data,datatoday2,datatoday3,datatoday4);
}

function settodayval2(boxclearflag){

	if(setTimeoutt) clearInterval(setTimeoutt); 
console.log(123);
	//随机取时间区间值,后期可以删掉bengin-------------------------
	var data5 = [], datatoday6 = [], datatoday7 = [], datatoday8 = [];
	var totalPoints = 100;
	
	function getdata2(){
	
		data5.length = 0; 
		var updateInterval;

		var now = (new Date(myYear, myMonth, myDay, myHours, myMinutes-32)).getTime();
		while (data5.length < totalPoints) {     
			var y = Math.random() * 100;
			updateInterval = 1000*60*2;
			
			var t = [now += updateInterval, y];
			data5.push(t);
			
			y = Math.random() * 100;
			t = [now += updateInterval, y];
			datatoday6.push(t);
			
			y = Math.random() * 100;
			t = [now += updateInterval, y];
			datatoday7.push(t);

			y = Math.random() * 100;
			t = [now += updateInterval, y];
			datatoday8.push(t);
		}
	}
	
	getdata2();

	//随机取时间区间值,后期可以删掉end------------------------

    updatetoday2(data5,datatoday6,datatoday7,datatoday8,boxclearflag);
}

function updatetoday2(data5,datatoday6,datatoday7,datatoday8,boxclearflag){
	var myDate = new Date(), myYear = myDate.getFullYear(), myMonth = myDate.getMonth(),  myDay = myDate.getDate(),
	myHours = myDate.getHours(), myMinutes = myDate.getMinutes(), mySeconds = myDate.getSeconds();
	optionstoday.xaxis.min = (new Date(myYear, myMonth, myDay, myHours, myMinutes-30)).getTime()
	optionstoday.xaxis.max = (new Date(myYear,myMonth, myDay, myHours, myMinutes, mySeconds)).getTime();
	
console.log(boxclearflag);

	if(jiaotiboxtoday == 1){
		if(boxclearflag == null || boxclearflag == undefined|| boxclearflag == "jiaotibox"){
			datasettoday = [
				{ label: dataset[0].label, data: data5},
				{ label:  dataset[1].label, data: datatoday6}
			];
			$.plot("#chart-flot-box", datasettoday, optionstoday);	console.log("我是交易setTimeout11");
			var jiaotiboxclearflag = "jiaotibox";
			jiaotiboxclear = setTimeout("settodayval2('" + jiaotiboxclearflag + "')", 1000*60*2);
		}	
	}
	
	if(userboxtoday == 1){
		if(boxclearflag == null || boxclearflag == undefined || boxclearflag == "userbox"){
			datasettoday2 = [
					{ label: dataset2[0].label, data: data5},
					{ label:  dataset2[1].label, data: datatoday6},
					{ label: dataset2[2].label, data: datatoday7},
					{ label:  dataset2[3].label, data: datatoday8}
			];
				
			$.plot("#chart-flot-box2", datasettoday2, optionstoday);	console.log("我是用户setTimeout11");
			var userboxclearflag = "userbox";
			userboxclear = setTimeout("settodayval2('" + userboxclearflag + "')", 1000*60*2);
		}	
	}
	
	if(guahaoboxtoday == 1){
		if(boxclearflag == null || boxclearflag == undefined || boxclearflag == "guahaobox"){
			datasettoday3 = [
				{ label: dataset[0].label, data: data5},
				{ label:  dataset[1].label, data: datatoday6}
			];
			$.plot("#chart-flot-box3", datasettoday3, optionstoday);	console.log("我是挂号setTimeout11");
			var guahaoboxclearflag = "guahaobox";
			guahaoboxclear = setTimeout("settodayval2('" + guahaoboxclearflag + "')", 1000*60*2);
		}	
	}
	
	if(othertiboxtoday == 1){
		if(boxclearflag == null || boxclearflag == undefined || boxclearflag == "othertibox"){
			datasettoday4 = [
					{ label: dataset4[0].label, data: data5},
					{ label:  dataset4[1].label, data: datatoday6},
					{ label:  dataset4[2].label, data: datatoday8}
			];
			$.plot("#chart-flot-box4", datasettoday4, optionstoday);	console.log("我是其他setTimeout11");
			var othertiboxclearflag = "othertibox";
			othertiboxclear = setTimeout("settodayval2('" + othertiboxclearflag + "')", 1000*60*2);	
		}	
	}	
	
}

var datasettoday,datasettoday2,datasettoday3,datasettoday4,optionstoday;

function updatetoday(data,datatoday2,datatoday3,datatoday4){
	var container = $("#"+dataid);

	optionstoday = {
		series: {
			lines: {
				show: true
			},
			points: {
				show: true
			}
		},
		xaxis: {
			mode: "time",
			tickSize: [2,"minute"],
			minTickSize: [2,"minute"],
			min: (new Date(myYear, myMonth, myDay, myHours, myMinutes-30)).getTime(),
			max: (new Date(myYear,myMonth, myDay, myHours, myMinutes, mySeconds)).getTime(),
			color: "#fff",
			tickFormatter: function(v, axis){
					var date = new Date(v);
					if (date.getMinutes() % 2 == 0) {
						var hours = date.getHours() < 10 ? "0" + date.getHours() : date.getHours();
						var minutes = date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes();
						return hours + ":" + minutes;
					} else {
						return "";
					}
			}
		},
		yaxis: {
			min: 0,
			max: 100,        
		},
		legend: {
			noColumns: 0,
			labelBoxBorderColor: "#fff",
			container:container.next(".chart-flot-box-legend"),
			backgroundColor:"#fff",
			labelFormatter: function(label, series){
				return '<div style="font-size:14px;text-align:left;color:#333;margin-left: 10px;">'+label+'</div>';
			}
		},
		grid: {
			clickable: true,
			hoverable: true,
			borderWidth: 1,
			borderColor: "#fff",
			color:"#333"
		}
	};

	switch(dataid)
	{
		case "chart-flot-box":
			datasettoday = [
				{ label: dataset[0].label, data: data},
				{ label:  dataset[1].label, data: datatoday2}
			];

			$("#jiaotibox").attr("dataicheckflag","3");
			optionstoday["colors"] = ["#ff8b3d","#32d2c9"];
			jiaotiboxtoday = 1;
			boxclearflag = "jiaotibox";
			
			var plot = $.plot(container, datasettoday, optionstoday);
			
			break;
		case "chart-flot-box2":
			datasettoday2 = [
				{ label: dataset2[0].label, data: data},
				{ label:  dataset2[1].label, data: datatoday2},
				{ label: dataset2[2].label, data: datatoday3},
				{ label:  dataset2[3].label, data: datatoday4}
			];
			
			$("#userbox").attr("dataicheckflag","3");
			optionstoday["colors"] = ["#ff8b3d","#32d2c9", "#8175c7", "#5fbf00"];
			userboxtoday = 1;
			boxclearflag = "userbox";
			
			var plot = $.plot(container, datasettoday2, optionstoday);	
			
			break;
		case "chart-flot-box3":
			datasettoday3 = [
				{ label: dataset3[0].label, data: data},
				{ label:  dataset3[1].label, data: datatoday2}
			];
			
			$("#guahaobox").attr("dataicheckflag","3");
			optionstoday["colors"] = ["#32d2c9", "#ff8b3d"];
			guahaoboxtoday = 1;
			boxclearflag = "guahaobox";
			
			var plot = $.plot(container, datasettoday3, optionstoday);	
			
			break;
		case "chart-flot-box4":
			datasettoday4 = [
				{ label: dataset4[0].label, data: data},
				{ label:  dataset4[1].label, data: datatoday2},
				{ label:  dataset4[2].label, data: datatoday3}
			];
			
			$("#othertibox").attr("dataicheckflag","3");
			optionstoday["colors"] = ["#32d2c9", "#ff8b3d","#8175c7"];
			othertiboxtoday = 1;
			boxclearflag = "othertibox";
			
			var plot = $.plot(container, datasettoday4, optionstoday);	
			
			break;	
		default:
			datasettoday = [
				{ label: dataset[0].label, data: data},
				{ label:  dataset[0].label, data: datatoday2}
			];

			$("#jiaotibox").attr("dataicheckflag","3");
			optionstoday["colors"] = ["#ff8b3d","#32d2c9"];
			jiaotiboxtoday = 1;
			boxclearflag = "jiaotibox";
			
			var plot = $.plot(container, datasettoday, optionstoday);	
		}
		
		setTimeoutt = setTimeout("settodayval2('" + boxclearflag + "')", 120);
}

/*------------------查询搜索-----------------*/
$(".btn-search").click(function(){
	$("#othertibox").find(".form-group").find("input").iCheck('check');
	$("#jiaotibox").find(".form-group").find("input").iCheck('check');
	$("#guahaobox").find(".form-group").find("input").iCheck('check');
	$("#userbox").find(".form-group").find("input").iCheck('check');
	
	if($(".icheckflag").find(".form-group").find("label").hasClass("noicheck")){
		$(".icheckflag").find(".form-group").find("label").removeClass("noicheck").addClass("icheck");
	} 
	
	if(othertiboxclear){ 
		clearInterval(othertiboxclear); 
	}
	if(jiaotiboxclear){
		clearInterval(jiaotiboxclear);
	}
	if(guahaoboxclear){
		clearInterval(guahaoboxclear);
	}
	if(userboxclear){
		clearInterval(userboxclear);
	}
	
	if(flotyearday == "dayflot"){
		if(dateFormat == null || dateFormat == undefined){
			alert("请选择最小时间区间"); 
			return;
		}else if(dateTextlast == null || dateTextlast == undefined){
			alert("请选择最大区间"); 
			return;
		}else{
		    setdayfun(daymin, daymax, daymin2, daymax2, "day");
		}
	}else if(flotyearday == "yearflot"){

		/*if(flotbenginmonth == null || flotbenginmonth == undefined){
			alert("请选择开始月份"); return false;
		}else if(flotendmonth == null || flotendmonth == undefined){
			alert("请选择结束月份"); return false;
		}else{
			setmonthfun(monthmin, monthmax, monthmin, monthmax, "month");
		}	*/
		
		
		if(flotbenginmonth == null || flotbenginmonth == undefined || flotendmonth == null || flotendmonth == undefined){
			flotbenginmonth = $(".flotbenginmonth").val();
			flotbenginyear  = $(".flotbenginmonth").find("option:selected").attr("datayear"); 
			flotendmonth = $(".flotendmonth").val();
			flotendyear  = $(".flotendmonth").find("option:selected").attr("datayear"); 

			monthmin = (new Date(flotbenginyear, flotbenginmonth, 1)).getTime();
			monthmax = (new Date(flotendyear, flotendmonth, 1)).getTime();
		
			setmonthfun(monthmin, monthmax, monthmin, monthmax, "month");	
		}else{	
			setmonthfun(monthmin, monthmax, monthmin, monthmax, "month");
		}
	}
})


/*----------------------------------------------------今日区间柱状图end---------*/

	
/*---------------选择月份控制柱状图的横坐标为月份值并重新绘制（公共函数）*/

var monthmin, monthmax;
$(".flotbenginmonth").change(function(){
	flotbenginmonth = $(this).val();
	flotbenginyear  = $(this).find("option:selected").attr("datayear"); 
})
$(".flotendmonth").change(function(){
	flotendmonth = $(this).val();
	flotendyear  = $(this).find("option:selected").attr("datayear");
	
	monthmin = (new Date(flotbenginyear, flotbenginmonth, 1)).getTime();
	monthmax = (new Date(flotendyear, flotendmonth, 1)).getTime();
})

function setmonthfun(){
	
/*------解决交易、用户、挂号、其他下拉框显示隐藏柱状图刚开始隐藏然后canver画布大小不对的问题。例如：刚开始选择了交易下拉，在选择月或者日的时候，再换用户下拉则用户那块box的画布canver的画布大小不正确*/

	if($("#othertibox").css("display") == 'block'){
		options4.xaxes[0].timeformat = "%y/%m";	
		options4.xaxes[0].minTickSize = [1, "month"];
		options4.xaxes[0].tickSize = [1,"month"];	
		options4.xaxes[0].tickFormatter = null;		
		options4.xaxes[0].min =  (new Date(flotbenginyear, flotbenginmonth, 1)).getTime();
		options4.xaxes[0].max = (new Date(flotendyear, flotendmonth, 1)).getTime();
		options4.colors = ["#32d2c9", "#ff8b3d","#8175c7"];	
		$("#othertibox").attr("dataicheckflag","1");
		$.plot("#chart-flot-box4", dataset4, options4);
	}	
	if($("#jiaotibox").css("display") == 'block'){	
		options.xaxes[0].timeformat = "%y/%m";	
		options.xaxes[0].minTickSize = [1, "month"];
		options.xaxes[0].tickSize = [1,"month"];
		options.xaxes[0].tickFormatter = null;	
		options.xaxes[0].min =  (new Date(flotbenginyear, flotbenginmonth, 1)).getTime(); 
		options.xaxes[0].max = (new Date(flotendyear, flotendmonth, 1)).getTime();
		options.colors = ["#ff8b3d", "#32d2c9"];
		$("#jiaotibox").attr("dataicheckflag","1");
		$.plot("#chart-flot-box", dataset, options);
	}
	if($("#userbox").css("display") == 'block'){	
		options2.xaxes[0].timeformat = "%y/%m";	
		options2.xaxes[0].minTickSize = [1, "month"];
		options2.xaxes[0].tickSize = [1,"month"];	
		options2.xaxes[0].tickFormatter = null;		
		options2.xaxes[0].min =  (new Date(flotbenginyear, flotbenginmonth, 1)).getTime();
		options2.xaxes[0].max = (new Date(flotendyear, flotendmonth, 1)).getTime();
		options2.colors = ["#ff8b3d", "#32d2c9", "#8175c7", "#5fbf00"];
		$("#userbox").attr("dataicheckflag","1");
		$.plot("#chart-flot-box2", dataset2, options2);
	}
	if($("#guahaobox").css("display") == 'block'){	
		options3.xaxes[0].timeformat = "%y/%m";	
		options3.xaxes[0].minTickSize = [1, "month"];
		options3.xaxes[0].tickSize = [1,"month"];
		options3.xaxes[0].tickFormatter = null;			
		options3.xaxes[0].min =  (new Date(flotbenginyear, flotbenginmonth, 1)).getTime();
		options3.xaxes[0].max = (new Date(flotendyear, flotendmonth, 1)).getTime();
		options3.colors = ["#32d2c9", "#ff8b3d"];
		$("#guahaobox").attr("dataicheckflag","1");
		$.plot("#chart-flot-box3", dataset3, options3);
	}
	//$(".focusstatus").siblings(".leverstatus").addClass("btn focusstatus").removeClass("leverstatus");
	//$(".focusstatus").addClass("leverstatus").removeClass("btn focusstatus");


}



/*--------------日期选择控改变柱状图横坐标为日期值并重新绘制（公共函数）*/	
		
var dateFormat, dateFormatyear, dateFormatmonth, dateFormatday, dateTextlast; 
var daymin, daymax, daymin2, daymax2;

$('#ui-datepicker').datepicker({
	numberOfMonths: 1,
	dateFormat: 'yy-mm-dd',
	onSelect: function(dateText, inst) {
		dateFormat = $('#ui-datepicker').datepicker({ dateFormat: "yy-mm-dd" }).val(); 
		dateFormat=dateFormat.split('-');
		
		$('#ui-datepicker-2').datepicker('option', 'minDate', new Date(dateFormat[0], parseInt(dateFormat[1]) - 1, dateFormat[2]));     //需要先设置ui-datepicker-2的值，不然不起作用
		
		$('#ui-datepicker-2').datepicker('option', 'maxDate', new Date(dateFormat[0], parseInt(dateFormat[1]), dateFormat[2])); 

		//console.log(parseInt(dateFormat[1]) - 1); console.log(parseInt(dateFormat[1])); console.log(parseInt(dateFormat[1])+1);

		//dateFormat=new Date(dateFormat[0], dateFormat[1], dateFormat[2]);
		//dateFormat=new Date(dateFormat); 

		//dateFormat = $('#ui-datepicker').datepicker('getDate');  dateFormat
		
		 //var dateFormat=new Date(Date.parse( $('#ui-datepicker').datepicker({ dateFormat: "yy/mm/dd" }).val()));
		//alert(dateFormat.valueOf());alert(typeof(dateFormat instanceof Date));
		//var dependedDate=new Date();
		//dateFormat = dependedDate.setTime(dateFormat);new Date(dateFormat[0], dateFormat[1], dateFormat[2])
	}
}); 
$('#ui-datepicker-2').datepicker({
	 numberOfMonths: 2,
	// minDate:new Date(dateFormatyear,dateFormatmonth - 1, dateFormatday),
	// maxDate: '+d',
	 dateFormat: 'yy-mm-dd',
	 onSelect: function(dateText, inst) {
			$("#ui-datepicker").datepicker("option","maxDate",dateText);  

			dateTextlast = $('#ui-datepicker-2').datepicker({ dateFormat: "yy-mm-dd" }).val(); 
			
			dateTextlast = dateText.split('-');
	 }
});

function setdayfun(){
	$('#myModal').modal({backdrop: 'static'}); 
	if($("#othertibox").css("display") == 'block'){
		options4.xaxes[0].timeformat = "%d";	
		options4.xaxes[0].tickFormatter = null;	
		options4.xaxes[0].minTickSize = [1, "day"];
		options4.xaxes[0].tickSize = [1,"day"];	
		if(dateFormat){
			options4.xaxes[0].min =  (new Date(dateFormat[0], dateFormat[1], dateFormat[2])).getTime();
		}else{
			options4.xaxes[0].min =  (new Date(myYear, myMonth, myDay)).getTime();
		}
		options4.xaxes[0].max = (new Date(dateTextlast[0], dateTextlast[1], dateTextlast[2])).getTime();
		options4.colors = ["#32d2c9", "#ff8b3d","#8175c7"];	 								
		$("#othertibox").attr("dataicheckflag","2");
		
		hling111 = [[new Date(myYear, 10, 1), 30],[new Date(myYear, 10, 2), 33],[new Date(myYear, 10, 4), 45], [new Date(myYear, 10,6), 56], [new Date(myYear, 10, 10), 39], [new Date(myYear, 10, 16), 25], [new Date(myYear, 10, 19), 73], [new Date(myYear, 10, 23), 35]];
		
		cos4111 = [[new Date(myYear, 10, 6), 30],[new Date(myYear, 10, 9), 33],[new Date(myYear, 10, 16), 45], [new Date(myYear, 10,18), 56], [new Date(myYear, 10, 19), 39], [new Date(myYear, 10, 21), 25], [new Date(myYear, 10, 27), 73], [new Date(myYear, 10, 29), 35]];
		
		sin4111 = [[new Date(myYear, 10, 1), 30],[new Date(myYear, 10, 15), 33],[new Date(myYear, 10, 4), 45], [new Date(myYear, 10,6), 56], [new Date(myYear, 10, 10), 39], [new Date(myYear, 10, 16), 25], [new Date(myYear, 10, 24), 73], [new Date(myYear,10, 27), 35]];
		
		dataset4 = [
			{ data: hling111, label: "报告单查看1111数"},
			{ data: cos4111, label: "问卷调查户数"},
			{ data: sin4111, label: "注销数"}
		];

		$.plot("#chart-flot-box4", dataset4, options4);
	}
	
	if($("#jiaotibox").css("display") == 'block'){				
		options.xaxes[0].timeformat = "%d";	
		options.xaxes[0].tickFormatter = null;	
		if(dateFormat){
			options.xaxes[0].min =  (new Date(dateFormat[0], dateFormat[1]-1, dateFormat[2])).getTime();
		}else{
			options.xaxes[0].min =  (new Date(myYear, myMonth, myDay)).getTime();
		}
		options.xaxes[0].max = (new Date(dateTextlast[0], dateTextlast[1]-1, dateTextlast[2])).getTime(); 
 		options.colors = ["#ff8b3d", "#32d2c9"];  
		$("#jiaotibox").attr("dataicheckflag","2");
		$.plot("#chart-flot-box", dataset, options);
	}	
	if($("#userbox").css("display") == 'block'){	
		options2.xaxes[0].timeformat = "%d";
		options2.xaxes[0].tickFormatter = null;		
		if(dateFormat){
			options2.xaxes[0].min =  (new Date(dateFormat[0], dateFormat[1]-1, dateFormat[2])).getTime();
		}else{
			options2.xaxes[0].min =  (new Date(myYear, myMonth, myDay)).getTime();
		}
		options2.xaxes[0].max = (new Date(dateTextlast[0], dateTextlast[1]-1, dateTextlast[2])).getTime();
		options2.colors = ["#ff8b3d", "#32d2c9", "#8175c7", "#5fbf00"];
		$("#userbox").attr("dataicheckflag","2");
		$.plot("#chart-flot-box2", dataset2, options2);
	}	
	if($("#guahaobox").css("display") == 'block'){	
		options3.xaxes[0].timeformat = "%d";
		options3.xaxes[0].tickFormatter = null;		
		if(dateFormat){
			options3.xaxes[0].min =  (new Date(dateFormat[0], dateFormat[1]-1, dateFormat[2])).getTime();
		}else{
			options3.xaxes[0].min =  (new Date(myYear, myMonth, myDay)).getTime();
		}
		options3.xaxes[0].max = (new Date(dateTextlast[0], dateTextlast[1]-1, dateTextlast[2])).getTime();
		options3.colors = ["#32d2c9", "#ff8b3d"];
		$("#guahaobox").attr("dataicheckflag","2");
		$.plot("#chart-flot-box3", dataset3, options3);
	}
	//$(".focusstatus").siblings(".leverstatus").addClass("btn focusstatus").removeClass("leverstatus");
	//$(".focusstatus").addClass("leverstatus").removeClass("btn focusstatus");
	
	$('#myModal').modal('hide');

}

/*-------------------------显示隐藏统计图丙块函数*/
$(".boxshowhide").change(function(){
	var boxshowhide = $(this).val(); 
	if(boxshowhide == "allboxshow"){
		$(".showhide").show();
		//$(".showhide").siblings(".showhide").find(".chart-flot").show();
	}else{
		$("#"+boxshowhide).show().siblings(".showhide").hide();
		
		//$("#"+boxshowhide).find(".chart-flot").show(); 
		//$("#"+boxshowhide).siblings(".showhide").find(".chart-flot").hide()
	}
})	
/*-------------------------月和日的下拉选项，显示隐藏日历控件的函数*/
var ptype,flotyearday="dayflot";
$(".flotyearday").change(function(){
    flotyearday = $(this).val();
	if(flotyearday == "yearflot"){
		$(".flotmonthchangbox").show();
		$(".flotyearchangboxUI").hide();			
	}else if(flotyearday == "dayflot"){
		$(".flotmonthchangbox").hide(); $(".flotyearchangboxUI").show();
		/*options4.xaxes[0].min = (new Date(myYear, 0, 1)).getTime(), options4.xaxes[0].max = (new Date(myYear+1, 0, 1)).getTime();
		options4.xaxes[0].tickSize = [1,"day"];	
		$.plot("#chart-flot-box4", dataset4, options4);*/
	}	
})
		

/*单选钮样式*/			
$('.icheckboxchart').iCheck({
	checkboxClass: 'icheckbox_flat-blue',
	radioClass: 'iradio_flat-blue'
});		

/*今日\累计按钮*/	  
$(".funs").click(function(){
	$(this).siblings(".focusstatus").removeClass("btn focusstatus").addClass("leverstatus");
	$(this).removeClass("leverstatus").addClass("btn focusstatus");
})


//鼠标移动到柱状图圆点上时显示的时间戳日期转换为年月日日期函数------------------------
	function getLocalTime(nS) {     
	   return new Date(parseInt(nS) * 1000).toLocaleString().replace(/:\d{1,2}$/,' ');     
	}   
//鼠标移动到柱状图圆点上时显示的时间戳日期转换为年月日日期函数-----END-------------------

</script>
  </body>
</html>